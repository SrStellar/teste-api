import { Router } from 'express';
import { authMiddleware } from '../../middleware/auth';
import { validate } from '../../middleware/validate';
import { availabilityQuerySchema, createAppointmentSchema } from '../../schemas/appointment';
import { getUnavailableSlots } from './availability.service';
import { deleteAppointment, getMyAppointments, postAppointment } from './appointment.controller';
export const appointmentRouter = Router();
apointmentRouter.get('/appointments/availability', validate(availabilityQuerySchema), async (req, res) => { const { barberId, date } = req.query; const unavailable = await getUnavailableSlots(parseInt(barberId, 10), date); res.json(unavailable); });
apointmentRouter.get('/user/appointments', authMiddleware, getMyAppointments);
apointmentRouter.post('/user/appointments', authMiddleware, validate(createAppointmentSchema), postAppointment);
apointmentRouter.delete('/user/appointments/:id', authMiddleware, deleteAppointment);
